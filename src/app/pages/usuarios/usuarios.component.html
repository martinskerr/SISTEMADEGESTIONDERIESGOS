<div style="padding: 20px; max-width: 1400px; margin: 0 auto;">
  
  <!-- Header -->
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
    <h2 style="margin: 0; color: #2c3e50; font-size: 28px;">ğŸ‘¥ GestiÃ³n de Usuarios</h2>
    <button 
      (click)="toggleFormulario()" 
      [style.background]="mostrarFormulario ? 'linear-gradient(135deg, #6c757d 0%, #495057 100%)' : 'linear-gradient(135deg, #28a745 0%, #20c997 100%)'"
      style="padding: 12px 24px; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 15px; font-weight: 600; box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);">
      <span style="font-size: 18px; margin-right: 5px;">{{ mostrarFormulario ? 'âœ–ï¸' : '+' }}</span>
      {{ mostrarFormulario ? 'Cancelar' : 'Nuevo Usuario' }}
    </button>
  </div>

  <!-- Mensajes -->
  <div *ngIf="mensaje" style="background: #d4edda; color: #155724; padding: 15px; border-radius: 6px; margin-bottom: 15px; font-weight: 500;">
    âœ… {{ mensaje }}
  </div>

  <div *ngIf="error" style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 6px; margin-bottom: 15px; font-weight: 500;">
    âŒ {{ error }}
  </div>

  <!-- Formulario -->
  <div *ngIf="mostrarFormulario" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 25px;">
    <h3 style="margin-top: 0; color: #2c3e50; margin-bottom: 20px;">
      {{ isEditMode ? 'âœï¸ Editar Usuario' : 'â• Nuevo Usuario' }}
    </h3>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
      <div>
        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #495057;">Nombre Completo *</label>
        <input 
          [(ngModel)]="nuevoUsuario.nombre"
          type="text"
          placeholder="Ej: Juan PÃ©rez"
          style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
      </div>

      <div>
        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #495057;">Email *</label>
        <input 
          [(ngModel)]="nuevoUsuario.email"
          type="email"
          placeholder="usuario@empresa.com"
          style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
      </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
      <div>
        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #495057;">
          ContraseÃ±a {{ isEditMode ? '(dejar vacÃ­o para no cambiar)' : '*' }}
        </label>
        <input 
          [(ngModel)]="nuevoUsuario.password"
          type="password"
          placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
          style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
      </div>

      <div>
        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #495057;">Rol *</label>
        <select 
          [(ngModel)]="nuevoUsuario.rol"
          style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
          <option *ngFor="let rol of roles" [value]="rol">{{ rol }}</option>
        </select>
      </div>

      <div>
        <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #495057;">Estado</label>
        <select 
          [(ngModel)]="nuevoUsuario.activo"
          style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px; font-size: 14px;">
          <option [value]="true">Activo</option>
          <option [value]="false">Inactivo</option>
        </select>
      </div>
    </div>

    <div style="display: flex; gap: 10px; margin-top: 20px;">
      <button 
        (click)="guardarUsuario()"
        style="padding: 12px 24px; background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; box-shadow: 0 2px 6px rgba(0, 123, 255, 0.3);">
        ğŸ’¾ {{ isEditMode ? 'Actualizar' : 'Guardar' }}
      </button>
      <button 
        (click)="cancelar()"
        style="padding: 12px 24px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
        Cancelar
      </button>
    </div>
  </div>

  <!-- Loading -->
  <p *ngIf="cargando" style="padding: 15px; border-radius: 6px; text-align: center; background: #e3f2fd; color: #1976d2;">
    â³ Cargando usuarios...
  </p>

  <!-- Tabla de usuarios -->
  <div *ngIf="!cargando && usuarios.length > 0" style="background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); overflow-x: auto;">
    <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
      <thead style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <tr>
          <th style="padding: 14px 12px; text-align: left; font-weight: 600; font-size: 13px; white-space: nowrap;">ID</th>
          <th style="padding: 14px 12px; text-align: left; font-weight: 600; font-size: 13px; white-space: nowrap;">Nombre</th>
          <th style="padding: 14px 12px; text-align: left; font-weight: 600; font-size: 13px; white-space: nowrap;">Email</th>
          <th style="padding: 14px 12px; text-align: center; font-weight: 600; font-size: 13px; white-space: nowrap;">Rol</th>
          <th style="padding: 14px 12px; text-align: center; font-weight: 600; font-size: 13px; white-space: nowrap;">Estado</th>
          <th style="padding: 14px 12px; text-align: center; font-weight: 600; font-size: 13px; white-space: nowrap;">Fecha Registro</th>
          <th style="padding: 14px 12px; text-align: center; font-weight: 600; font-size: 13px; white-space: nowrap;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of usuarios" style="border-bottom: 1px solid #e9ecef;">
          <td style="padding: 12px; font-weight: bold; color: #6c757d; font-size: 13px;">{{ usuario.id }}</td>
          <td style="padding: 12px; font-weight: 600; color: #2c3e50;">{{ usuario.nombre }}</td>
          <td style="padding: 12px; color: #6c757d;">{{ usuario.email }}</td>
          <td style="padding: 12px; text-align: center;">
            <span [style]="'padding: 5px 12px; border-radius: 20px; font-weight: 700; font-size: 12px; display: inline-block; color: white; background: ' + getRolBadgeColor(usuario.rol)">
              {{ usuario.rol }}
            </span>
          </td>
          <td style="padding: 12px; text-align: center;">
            <span [style]="'padding: 5px 12px; border-radius: 20px; font-weight: 700; font-size: 12px; display: inline-block; background: ' + (usuario.activo ? '#e8f5e9' : '#ffebee') + '; color: ' + (usuario.activo ? '#2e7d32' : '#c62828')">
              {{ usuario.activo ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td style="padding: 12px; text-align: center; color: #495057;">{{ usuario.fecha_registro | date:'dd/MM/yyyy' }}</td>
          <td style="padding: 12px; text-align: center; white-space: nowrap;">
            <button 
              (click)="editarUsuario(usuario)"
              style="padding: 6px 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; background: #e3f2fd; margin: 0 3px;"
              title="Editar">
              âœï¸
            </button>
            <button 
              (click)="eliminarUsuario(usuario.id, usuario.nombre)"
              *ngIf="usuario.activo"
              style="padding: 6px 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; background: #ffebee; margin: 0 3px;"
              title="Desactivar">
              ğŸš«
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Mensaje vacÃ­o -->
  <div *ngIf="!cargando && usuarios.length === 0" style="text-align: center; padding: 60px 20px; background: #f8f9fa; border-radius: 8px;">
    <p style="font-size: 18px; color: #6c757d; margin-bottom: 20px;">ğŸ“‹ No hay usuarios registrados.</p>
    <button 
      (click)="toggleFormulario()" 
      style="padding: 12px 24px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
      Crear primer usuario
    </button>
  </div>

</div>
